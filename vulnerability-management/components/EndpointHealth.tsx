'use client';

import { useState } from 'react';
import { Monitor, Smartphone, Printer, Wifi, HardDrive, Cpu, Activity, AlertTriangle, CheckCircle, XCircle } from 'lucide-react';

const EndpointHealth = () => {
  const [filterType, setFilterType] = useState('all');
  const [filterStatus, setFilterStatus] = useState('all');

  const endpoints = [
    {
      name: 'DESKTOP-WIN-001',
      type: 'Desktop',
      os: 'Windows 11 Pro',
      user: 'john.doe@company.com',
      status: 'Healthy',
      cpu: 34,
      memory: 58,
      disk: 72,
      uptime: '5d 12h',
      lastSeen: '2 min ago',
      ip: '192.168.1.101',
      antivirus: 'Updated',
      patches: 'Current',
    },
    {
      name: 'LAPTOP-MAC-042',
      type: 'Laptop',
      os: 'macOS Sonoma 14.3',
      user: 'jane.smith@company.com',
      status: 'Warning',
      cpu: 78,
      memory: 92,
      disk: 89,
      uptime: '12d 8h',
      lastSeen: '5 min ago',
      ip: '192.168.1.142',
      antivirus: 'Updated',
      patches: 'Pending',
    },
    {
      name: 'DESKTOP-WIN-025',
      type: 'Desktop',
      os: 'Windows 10 Pro',
      user: 'mike.johnson@company.com',
      status: 'Critical',
      cpu: 12,
      memory: 45,
      disk: 34,
      uptime: '42d 3h',
      lastSeen: '2h ago',
      ip: '192.168.1.125',
      antivirus: 'Outdated',
      patches: 'Outdated',
    },
    {
      name: 'IPHONE-15-PRO-08',
      type: 'Mobile',
      os: 'iOS 17.3',
      user: 'sarah.wilson@company.com',
      status: 'Healthy',
      cpu: 22,
      memory: 68,
      disk: 54,
      uptime: '3d 18h',
      lastSeen: '1 min ago',
      ip: '192.168.1.208',
      antivirus: 'N/A',
      patches: 'Current',
    },
    {
      name: 'PRINTER-HP-FL3-01',
      type: 'Printer',
      os: 'HP LaserJet Firmware',
      user: 'Floor 3 - Shared',
      status: 'Warning',
      cpu: 8,
      memory: 42,
      disk: 15,
      uptime: '89d 14h',
      lastSeen: '10 min ago',
      ip: '192.168.1.50',
      antivirus: 'N/A',
      patches: 'Current',
    },
    {
      name: 'LAPTOP-WIN-089',
      type: 'Laptop',
      os: 'Windows 11 Pro',
      user: 'alex.brown@company.com',
      status: 'Healthy',
      cpu: 45,
      memory: 71,
      disk: 63,
      uptime: '8d 5h',
      lastSeen: '3 min ago',
      ip: '192.168.1.189',
      antivirus: 'Updated',
      patches: 'Current',
    },
    {
      name: 'IPAD-PRO-12',
      type: 'Mobile',
      os: 'iPadOS 17.3',
      user: 'emily.davis@company.com',
      status: 'Healthy',
      cpu: 18,
      memory: 52,
      disk: 76,
      uptime: '6d 22h',
      lastSeen: '4 min ago',
      ip: '192.168.1.212',
      antivirus: 'N/A',
      patches: 'Current',
    },
    {
      name: 'DESKTOP-WIN-156',
      type: 'Desktop',
      os: 'Windows 10 Pro',
      user: 'chris.martinez@company.com',
      status: 'Warning',
      cpu: 89,
      memory: 94,
      disk: 91,
      uptime: '28d 16h',
      lastSeen: '8 min ago',
      ip: '192.168.1.156',
      antivirus: 'Updated',
      patches: 'Pending',
    },
  ];

  const filteredEndpoints = endpoints.filter(endpoint => {
    const matchesType = filterType === 'all' || endpoint.type === filterType;
    const matchesStatus = filterStatus === 'all' || endpoint.status === filterStatus;
    return matchesType && matchesStatus;
  });

  const statusConfig = {
    'Healthy': { icon: CheckCircle, color: 'text-green-600', bg: 'bg-green-100', border: 'border-green-300' },
    'Warning': { icon: AlertTriangle, color: 'text-yellow-600', bg: 'bg-yellow-100', border: 'border-yellow-300' },
    'Critical': { icon: XCircle, color: 'text-red-600', bg: 'bg-red-100', border: 'border-red-300' },
  };

  const typeIcons = {
    'Desktop': Monitor,
    'Laptop': Monitor,
    'Mobile': Smartphone,
    'Printer': Printer,
  };

  const getHealthColor = (value: number) => {
    if (value < 70) return 'bg-green-500';
    if (value < 85) return 'bg-yellow-500';
    return 'bg-red-500';
  };

  return (
    <div className="space-y-6">
      {/* Header Actions */}
      <div className="flex flex-wrap gap-4 items-center justify-between">
        <div className="flex gap-3">
          <select
            value={filterType}
            onChange={(e) => setFilterType(e.target.value)}
            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">All Types</option>
            <option value="Desktop">Desktops</option>
            <option value="Laptop">Laptops</option>
            <option value="Mobile">Mobile Devices</option>
            <option value="Printer">Printers</option>
          </select>

          <select
            value={filterStatus}
            onChange={(e) => setFilterStatus(e.target.value)}
            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          >
            <option value="all">All Status</option>
            <option value="Healthy">Healthy</option>
            <option value="Warning">Warning</option>
            <option value="Critical">Critical</option>
          </select>
        </div>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
        <div className="bg-white p-4 rounded-lg border-l-4 border-blue-500 shadow-sm">
          <p className="text-sm text-gray-600">Total Endpoints</p>
          <p className="text-2xl font-bold text-gray-800">{endpoints.length}</p>
        </div>
        <div className="bg-white p-4 rounded-lg border-l-4 border-green-500 shadow-sm">
          <p className="text-sm text-gray-600">Healthy</p>
          <p className="text-2xl font-bold text-green-600">
            {endpoints.filter(e => e.status === 'Healthy').length}
          </p>
        </div>
        <div className="bg-white p-4 rounded-lg border-l-4 border-yellow-500 shadow-sm">
          <p className="text-sm text-gray-600">Warning</p>
          <p className="text-2xl font-bold text-yellow-600">
            {endpoints.filter(e => e.status === 'Warning').length}
          </p>
        </div>
        <div className="bg-white p-4 rounded-lg border-l-4 border-red-500 shadow-sm">
          <p className="text-sm text-gray-600">Critical</p>
          <p className="text-2xl font-bold text-red-600">
            {endpoints.filter(e => e.status === 'Critical').length}
          </p>
        </div>
        <div className="bg-white p-4 rounded-lg border-l-4 border-purple-500 shadow-sm">
          <p className="text-sm text-gray-600">Offline</p>
          <p className="text-2xl font-bold text-purple-600">0</p>
        </div>
      </div>

      {/* Endpoints Grid */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {filteredEndpoints.map((endpoint) => {
          const statusConf = statusConfig[endpoint.status as keyof typeof statusConfig];
          const StatusIcon = statusConf.icon;
          const TypeIcon = typeIcons[endpoint.type as keyof typeof typeIcons];

          return (
            <div key={endpoint.name} className={`bg-white rounded-lg shadow-md border-2 ${statusConf.border} p-6`}>
              <div className="flex items-start justify-between mb-4">
                <div className="flex items-center gap-3">
                  <div className="bg-blue-100 p-3 rounded-lg">
                    <TypeIcon className="text-blue-600" size={24} />
                  </div>
                  <div>
                    <h3 className="text-lg font-bold text-gray-800">{endpoint.name}</h3>
                    <p className="text-sm text-gray-600">{endpoint.type} â€¢ {endpoint.os}</p>
                  </div>
                </div>
                <div className={`${statusConf.bg} px-3 py-1 rounded-full flex items-center gap-2`}>
                  <StatusIcon className={statusConf.color} size={16} />
                  <span className={`text-sm font-semibold ${statusConf.color}`}>{endpoint.status}</span>
                </div>
              </div>

              <div className="space-y-3 mb-4">
                <div className="flex items-center justify-between text-sm">
                  <div className="flex items-center gap-2 text-gray-600">
                    <Cpu size={16} />
                    <span>CPU Usage</span>
                  </div>
                  <span className="font-semibold text-gray-800">{endpoint.cpu}%</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div className={`h-2 rounded-full ${getHealthColor(endpoint.cpu)}`} style={{ width: `${endpoint.cpu}%` }}></div>
                </div>

                <div className="flex items-center justify-between text-sm">
                  <div className="flex items-center gap-2 text-gray-600">
                    <Activity size={16} />
                    <span>Memory Usage</span>
                  </div>
                  <span className="font-semibold text-gray-800">{endpoint.memory}%</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div className={`h-2 rounded-full ${getHealthColor(endpoint.memory)}`} style={{ width: `${endpoint.memory}%` }}></div>
                </div>

                <div className="flex items-center justify-between text-sm">
                  <div className="flex items-center gap-2 text-gray-600">
                    <HardDrive size={16} />
                    <span>Disk Usage</span>
                  </div>
                  <span className="font-semibold text-gray-800">{endpoint.disk}%</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div className={`h-2 rounded-full ${getHealthColor(endpoint.disk)}`} style={{ width: `${endpoint.disk}%` }}></div>
                </div>
              </div>

              <div className="grid grid-cols-2 gap-3 text-sm pt-4 border-t border-gray-200">
                <div>
                  <p className="text-gray-600">User</p>
                  <p className="font-semibold text-gray-800 truncate">{endpoint.user}</p>
                </div>
                <div>
                  <p className="text-gray-600">IP Address</p>
                  <p className="font-semibold text-gray-800">{endpoint.ip}</p>
                </div>
                <div>
                  <p className="text-gray-600">Uptime</p>
                  <p className="font-semibold text-gray-800">{endpoint.uptime}</p>
                </div>
                <div>
                  <p className="text-gray-600">Last Seen</p>
                  <p className="font-semibold text-gray-800">{endpoint.lastSeen}</p>
                </div>
                <div>
                  <p className="text-gray-600">Antivirus</p>
                  <p className={`font-semibold ${endpoint.antivirus === 'Updated' ? 'text-green-600' : endpoint.antivirus === 'N/A' ? 'text-gray-600' : 'text-red-600'}`}>
                    {endpoint.antivirus}
                  </p>
                </div>
                <div>
                  <p className="text-gray-600">Patches</p>
                  <p className={`font-semibold ${endpoint.patches === 'Current' ? 'text-green-600' : 'text-orange-600'}`}>
                    {endpoint.patches}
                  </p>
                </div>
              </div>

              <div className="flex gap-2 mt-4 pt-4 border-t border-gray-200">
                <button className="flex-1 px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors">
                  Remote Access
                </button>
                <button className="flex-1 px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-colors">
                  Run Diagnostics
                </button>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

export default EndpointHealth;
